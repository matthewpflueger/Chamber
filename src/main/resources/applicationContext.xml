<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:akka="http://akka.io/schema/akka"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans
	        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
            http://www.springframework.org/schema/util
            http://www.springframework.org/schema/util/spring-util-3.0.xsd
            http://akka.io/schema/akka
            http://akka.io/akka-1.3.1.xsd"
       default-init-method="init"
       default-destroy-method="destroy">


    <import resource="classpath:chamber-properties.xml" />

    <import resource="classpath:database.xml" />


    <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="cacheSeconds" value="-1" /> <!-- cache forever -->
        <property name="basenames">
            <list>
                <value>${http.urls.messages}/messages</value>
                <value>${http.urls.messages}/errors</value>
            </list>
        </property>
    </bean>

    <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean" >
        <property name="validationMessageSource" ref="messageSource" />
    </bean>

    <bean id="globalsManager" class="com.echoed.chamber.services.GlobalsManager" >
        <property name="urlsProperties" ref="urlsProperties" />
        <property name="gitProperties" ref="gitProperties" />
        <property name="facebookClientId" value="${facebook.clientId}" />
    </bean>

    <bean id="encrypter" class="com.echoed.util.Encrypter" >
        <property name="secret" value="${echoed.secret}" />
    </bean>


    <bean id="javaMailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
        <property name="defaultEncoding" value="UTF-8" />
        <property name="username" value="${mail.user}" />
        <property name="password" value="${mail.password}" />
        <property name="javaMailProperties" ref="mailProperties" />
    </bean>


    <!-- This is here because the mail service needs to resolve mustache templates -->
    <bean id="mustacheEngine" class="com.echoed.util.mustache.MustacheEngine">
        <property name="prefix" value="${mustache.prefix}" />
        <property name="suffix" value="${mustache.suffix}" />
        <property name="defaultValue" value="${mustache.defaultValue}" />
    </bean>


    <bean id="cacheManager" class="com.echoed.cache.LocalCacheManager">
        <property name="expireInMinutes" value="${cache.expireInMinutes}" />
    </bean>


    <bean id="blobStore" class="com.echoed.util.BlobStore">
        <property name="provider" value="${blobstore.provider}" />
        <property name="username" value="${blobstore.identity}" />
        <property name="credential" value="${blobstore.credential}" />
        <property name="container" value="${blobstore.container}" />
        <property name="containerUrl" value="${blobstore.containerUrl}" />
    </bean>


    <bean id="imageService" class="com.echoed.chamber.services.image.ImageServiceActorClient">
        <property name="actorRef" ref="imageServiceActor" />
    </bean>

    <bean id="emailService" class="com.echoed.chamber.services.email.EmailServiceActorClient">
        <property name="actorRef" ref="emailServiceActor" />
    </bean>
    
    <bean id="feedService" class="com.echoed.chamber.services.feed.FeedServiceActorClient">
        <property name="feedServiceActor" ref="feedServiceActor" />
    </bean>

    <bean id="facebookAccess" class="com.echoed.chamber.services.facebook.FacebookAccessActorClient">
        <property name="actorRef" ref="facebookAccessActor" />
    </bean>

    <bean id="facebookServiceCreator" class="com.echoed.chamber.services.facebook.FacebookServiceCreatorActorClient">
        <property name="facebookServiceCreatorActor" ref="facebookServiceCreatorActor" />
    </bean>

    <bean id="facebookServiceLocator" class="com.echoed.chamber.services.facebook.FacebookServiceLocatorActorClient">
        <property name="facebookServiceLocatorActor" ref="facebookServiceLocatorActor" />
    </bean>

    <bean id="echoService" class="com.echoed.chamber.services.echo.EchoServiceActorClient">
        <property name="echoServiceActor" ref="echoServiceActor" />
    </bean>

    <bean id="twitterAccess" class="com.echoed.chamber.services.twitter.TwitterAccessActorClient">
        <property name="twitterAccessActor" ref="twitterAccessActor" />
    </bean>

    <bean id="twitterServiceCreator" class="com.echoed.chamber.services.twitter.TwitterServiceCreatorActorClient">
        <property name="twitterServiceCreatorActor" ref="twitterServiceCreatorActor" />
    </bean>

    <bean id="twitterServiceLocator" class="com.echoed.chamber.services.twitter.TwitterServiceLocatorActorClient">
        <property name="twitterServiceLocatorActor" ref="twitterServiceLocatorActor" />
    </bean>

    <bean id="echoedUserServiceCreator" class="com.echoed.chamber.services.echoeduser.EchoedUserServiceCreatorActorClient">
        <property name="echoedUserServiceCreatorActor" ref="echoedUserServiceCreatorActor" />
    </bean>

    <bean id="echoedUserServiceLocator" class="com.echoed.chamber.services.echoeduser.EchoedUserServiceLocatorActorClient">
        <property name="echoedUserServiceLocatorActor" ref="echoedUserServiceLocatorActor" />
    </bean>

    <bean id="partnerServiceManager" class="com.echoed.chamber.services.partner.PartnerServiceManagerActorClient">
        <property name="actorRef" ref="partnerServiceManagerActor" />
    </bean>

    <bean id="partnerUserServiceCreator" class="com.echoed.chamber.services.partneruser.PartnerUserServiceCreatorActorClient">
        <property name="partnerUserServiceCreatorActor" ref="partnerUserServiceCreatorActor" />
    </bean>

    <bean id="partnerUserServiceLocator" class="com.echoed.chamber.services.partneruser.PartnerUserServiceLocatorActorClient">
        <property name="partnerUserServiceLocatorActor" ref="partnerUserServiceLocatorActor" />
    </bean>

    <bean id="adminUserServiceCreator" class="com.echoed.chamber.services.adminuser.AdminUserServiceCreatorActorClient">
        <property name="adminUserServiceCreatorActor" ref="adminUserServiceCreatorActor" />
    </bean>

    <bean id="adminUserServiceLocator" class="com.echoed.chamber.services.adminuser.AdminUserServiceLocatorActorClient">
        <property name="adminUserServiceLocatorActor"  ref="adminUserServiceLocatorActor" />
    </bean>
    
    <bean id="shopifyPartnerServiceManager" class="com.echoed.chamber.services.partner.shopify.ShopifyPartnerServiceManagerActorClient">
        <property name="actorRef" ref="shopifyPartnerServiceManagerActor" />
    </bean>

    <bean id="shopifyAccess" class="com.echoed.chamber.services.partner.shopify.ShopifyAccessActorClient">
        <property name="shopifyAccessActor" ref="shopifyAccessActor"/>
    </bean>


    <util:map id="cloudPartners">
        <entry key="Shopify" value-ref="shopifyPartnerServiceManager" />
    </util:map>

    <akka:untyped-actor
            id="partnerServiceManagerActor"
            implementation="com.echoed.chamber.services.partner.PartnerServiceManagerActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="partnerDao" ref="partnerDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerSettingsDao" ref="partnerSettingsDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerUserDao" ref="partnerUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoDao" ref="echoDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoMetricsDao" ref="echoMetricsDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageDao" ref="imageDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageService" ref="imageService" />
        <!--suppress SpringModelInspection -->
        <property name="encrypter" ref="encrypter" />
        <!--suppress SpringModelInspection -->
        <property name="transactionTemplate" ref="transactionTemplate" />
        <!--suppress SpringModelInspection -->
        <property name="emailService" ref="emailService" />
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
        <!--suppress SpringModelInspection -->
        <property name="cloudPartners" ref="cloudPartners" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="imageServiceActor"
            implementation="com.echoed.chamber.services.image.ImageServiceActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="imageDao" ref="imageDao" />
        <!--suppress SpringModelInspection -->
        <property name="blobStore" ref="blobStore" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="emailServiceActor"
            implementation="com.echoed.chamber.services.email.EmailServiceActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="javaMailSender" ref="javaMailSender" />
        <!--suppress SpringModelInspection -->
        <property name="mustacheEngine" ref="mustacheEngine" />
        <!--suppress SpringModelInspection -->
        <property name="mailProperties" ref="mailProperties" />
        <!--suppress SpringModelInspection -->
        <property name="globalsManager" ref="globalsManager" />
    </akka:untyped-actor>


    <akka:untyped-actor
            id="facebookAccessActor"
            implementation="com.echoed.chamber.services.facebook.FacebookAccessActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="properties" ref="facebookAccessProperties" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="facebookServiceCreatorActor"
            implementation="com.echoed.chamber.services.facebook.FacebookServiceCreatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="facebookAccess" ref="facebookAccess" />
        <!--suppress SpringModelInspection -->
        <property name="facebookUserDao" ref="facebookUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="facebookPostDao" ref="facebookPostDao" />
        <!--suppress SpringModelInspection -->
        <property name="facebookFriendDao" ref="facebookFriendDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerDao" ref="partnerDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerSettingsDao" ref="partnerSettingsDao"/>
        <!--suppress SpringModelInspection -->
        <property name="urlsProperties" ref="urlsProperties" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="facebookServiceLocatorActor"
            implementation="com.echoed.chamber.services.facebook.FacebookServiceLocatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="facebookServiceCreator" ref="facebookServiceCreator" />
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>

    <util:list id="filteredUserAgents">
        <value>Googlebot</value>
        <value>bitlybot</value>
        <value>Crowsnest</value>
        <value>facebookexternalhit</value>
        <value>Jakarta</value>
        <value>Java</value>
        <value>JS-Kit</value>
        <value>LinkedInBot</value>
        <value>news.me extractor</value>
        <value>newsme</value>
        <value>NING</value>
        <value>RockMeltEmbedService</value>
        <value>ShowyouBot</value>
        <value>Twitterbot</value>
        <value>Voyager</value>
        <value>Yepi</value>
        <value>Yeti</value>
        <value>TweetedTimes Bot</value>
        <value>TweetmemeBot</value>
        <value>YandexBot</value>
        <value>Butterfly</value>
        <value>AppEngine-Google</value>
    </util:list>

    <akka:untyped-actor
            id="echoServiceActor"
            implementation="com.echoed.chamber.services.echo.EchoServiceActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="echoDao" ref="echoDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoMetricsDao" ref="echoMetricsDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerDao" ref="partnerDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerSettingsDao" ref="partnerSettingsDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoClickDao" ref="echoClickDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageDao" ref="imageDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageService" ref="imageService" />
        <!--suppress SpringModelInspection -->
        <property name="transactionTemplate" ref="transactionTemplate" />
        <!--suppress SpringModelInspection -->
        <property name="filteredUserAgents" ref="filteredUserAgents" />
    </akka:untyped-actor>

    <akka:untyped-actor
           id="twitterAccessActor"
           implementation="com.echoed.chamber.services.twitter.TwitterAccessActor"
           autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="properties" ref="twitterAccessProperties"/>
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>

    <akka:untyped-actor
           id="twitterServiceCreatorActor"
           implementation="com.echoed.chamber.services.twitter.TwitterServiceCreatorActor"
           autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="twitterAccess" ref="twitterAccess" />
        <!--suppress SpringModelInspection -->
        <property name="twitterUserDao" ref="twitterUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="twitterStatusDao" ref="twitterStatusDao" />
        <!--suppress SpringModelInspection -->
        <property name="urlsProperties" ref="urlsProperties" />
    </akka:untyped-actor>

    <akka:untyped-actor
           id="twitterServiceLocatorActor"
           implementation="com.echoed.chamber.services.twitter.TwitterServiceLocatorActor"
           autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="twitterServiceCreator" ref="twitterServiceCreator"/>
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="echoedUserServiceCreatorActor"
            implementation="com.echoed.chamber.services.echoeduser.EchoedUserServiceCreatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="twitterServiceLocator" ref="twitterServiceLocator"/>
        <!--suppress SpringModelInspection -->
        <property name="facebookServiceLocator" ref="facebookServiceLocator"/>
        <!--suppress SpringModelInspection -->
        <property name="echoedUserDao" ref="echoedUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="closetDao" ref="closetDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoedFriendDao" ref="echoedFriendDao" />
        <!--suppress SpringModelInspection -->
        <property name="feedDao" ref="feedDao"/>
        <!--suppress SpringModelInspection -->
        <property name="echoDao" ref="echoDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoMetricsDao" ref="echoMetricsDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerSettingsDao" ref="partnerSettingsDao" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="echoedUserServiceLocatorActor"
            implementation="com.echoed.chamber.services.echoeduser.EchoedUserServiceLocatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="echoedUserServiceCreator" ref="echoedUserServiceCreator" />
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="partnerUserServiceCreatorActor"
            implementation="com.echoed.chamber.services.partneruser.PartnerUserServiceCreatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="partnerUserDao" ref="partnerUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerViewDao" ref="partnerViewDao"/>
    </akka:untyped-actor>


    <akka:untyped-actor
            id="partnerUserServiceLocatorActor"
            implementation="com.echoed.chamber.services.partneruser.PartnerUserServiceLocatorActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="partnerUserServiceCreator" ref="partnerUserServiceCreator" />
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="adminUserServiceCreatorActor"
            implementation="com.echoed.chamber.services.adminuser.AdminUserServiceCreatorActor"
            autostart="true">
            <!--suppress SpringModelInspection -->
            <property name="adminUserDao" ref="adminUserDao" />
            <!--suppress SpringModelInspection -->
            <property name="adminViewDao" ref="adminViewDao" />
    </akka:untyped-actor>

    <akka:untyped-actor
            id="adminUserServiceLocatorActor"
            implementation="com.echoed.chamber.services.adminuser.AdminUserServiceLocatorActor"
            autostart="true">
            <!--suppress SpringModelInspection -->
            <property name="adminUserServiceCreator" ref="adminUserServiceCreator" />
            <!--suppress SpringModelInspection -->
            <property name="cacheManager" ref="cacheManager" />
    </akka:untyped-actor>
    

    <akka:untyped-actor
            id="shopifyPartnerServiceManagerActor"
            implementation="com.echoed.chamber.services.partner.shopify.ShopifyPartnerServiceManagerActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="partnerDao" ref="partnerDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerSettingsDao" ref="partnerSettingsDao" />
        <!--suppress SpringModelInspection -->
        <property name="partnerUserDao" ref="partnerUserDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoDao" ref="echoDao" />
        <!--suppress SpringModelInspection -->
        <property name="echoMetricsDao" ref="echoMetricsDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageDao" ref="imageDao" />
        <!--suppress SpringModelInspection -->
        <property name="imageService" ref="imageService" />
        <!--suppress SpringModelInspection -->
        <property name="encrypter" ref="encrypter" />
        <!--suppress SpringModelInspection -->
        <property name="transactionTemplate" ref="transactionTemplate" />
        <!--suppress SpringModelInspection -->
        <property name="emailService" ref="emailService" />
        <!--suppress SpringModelInspection -->
        <property name="cacheManager" ref="cacheManager" />
        <!--suppress SpringModelInspection -->
        <property name="shopifyAccess" ref="shopifyAccess" />
        <!--suppress SpringModelInspection -->
        <property name="partnerServiceManager" ref="partnerServiceManager" />
        <!--suppress SpringModelInspection -->
        <property name="shopifyPartnerDao" ref="shopifyPartnerDao" />
        <!--suppress SpringModelInspection -->
        <property name="properties" ref="shopifyProperties" />
    </akka:untyped-actor>


    <akka:untyped-actor
            id="shopifyAccessActor"
            implementation="com.echoed.chamber.services.partner.shopify.ShopifyAccessActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="properties" ref="shopifyProperties" />
    </akka:untyped-actor>

    

    <akka:untyped-actor
            id="facebookPostCrawlerActor"
            implementation="com.echoed.chamber.services.facebook.FacebookPostCrawlerActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="facebookPostDao" ref="facebookPostDao" />
        <!--suppress SpringModelInspection -->
        <property name="facebookLikeDao" ref="facebookLikeDao" />
        <!--suppress SpringModelInspection -->
        <property name="facebookCommentDao" ref="facebookCommentDao" />
        <!--suppress SpringModelInspection -->
        <property name="facebookAccess" ref="facebookAccess" />
    </akka:untyped-actor>
    
    <akka:untyped-actor
            id="geoLocationServiceActor"
            implementation="com.echoed.chamber.services.geolocation.GeoLocationServiceActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="geoLocationDao" ref="geoLocationDao" />
        <!--suppress SpringModelInspection -->
        <property name="properties" ref="geoLocationProperties" />
    </akka:untyped-actor>
    
    <akka:untyped-actor
            id="feedServiceActor"
            implementation="com.echoed.chamber.services.feed.FeedServiceActor"
            autostart="true">
        <!--suppress SpringModelInspection -->
        <property name="feedDao" ref="feedDao" />
    </akka:untyped-actor>

</beans>

<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.echoed.chamber.dao.FacebookCommentDao">

    <cache-ref namespace="com.echoed.chamber.dao.cache.Default" />

    <resultMap id="facebookCommentResult" type="com.echoed.chamber.domain.FacebookComment">
        <constructor>
            <idArg column="id" javaType="String" />
            <arg column="updatedOn" javaType="Date" />
            <arg column="createdOn" javaType="Date" />
            <arg column="facebookPostId" javaType="String" />
            <arg column="facebookUserId" javaType="String" />
            <arg column="echoedUserId" javaType="String" />
            <arg column="facebookId" javaType="String" />
            <arg column="byFacebookId" javaType="String" />
            <arg column="name" javaType="String" />
            <arg column="message" javaType="String" />
            <arg column="createdAt" javaType="Date" />
        </constructor>
    </resultMap>


    <select id="findByFacebookPostId" resultMap="facebookCommentResult">
    	select * from FacebookComment where facebookPostId = #{facebookPostId}
    </select>

    <insert id="insertOrUpdate" parameterType="com.echoed.chamber.domain.FacebookComment">
    	insert into FacebookComment(
                id,
                createdOn,
                facebookPostId,
                facebookUserId,
                echoedUserId,
                facebookId,
                byFacebookId,
                name,
                message,
                createdAt)
        values (
                #{id},
                #{createdOn},
                #{facebookPostId},
                #{facebookUserId},
                #{echoedUserId},
                #{facebookId},
                #{byFacebookId},
                #{name},
                #{message},
                #{createdAt})
        on duplicate key update
                name = #{name}
    </insert>

    <delete id="deleteByFacebookPostId">
        delete from FacebookComment where facebookPostId=#{facebookPostId}
    </delete>

</mapper>

{{<user_super}}

{{$header}}
    <link rel="stylesheet" type="text/css" href="{{urls.css}}/echoed-fileuploader.css"/>
    <script type="text/template" id="templates-components-product">
        <div class="item_content">
            <div class="item_hover" style="display:none;">
                <div class="item_hover_wrap">
                </div>
            </div>
            <img class="exhibit_image" width="230px" src=""/>
            <div class="item_text">
            </div>
        </div>
    </script>
    <script type="text/template" id="templates-components-story">
        <div class="item_content">
            <img class="exhibit_image" width="230px" height="288px" src="http://c10415403.r3.cf2.rackcdn.com/3dTpjByI877wv4xHmvw1PQ-230x288-sized.jpg"/>
            <div class="story_overlay">
                <div class="story_title">
                    My Skinny Ring Story<br/>
                    by Evan's Hair<br/>
                </div>
                <div class="story_text">
                    "This is the best product I've ever bought"
                </div>
            </div>
        </div>
    </script>
    <script type="text/templates" id="templates-components-profile">
        <div class="profile_content">
            <div class="profile_username"></div>
            <div class="clearfix">
                <div class="profile_stat">
                    <div class="profile_reward"></div>
                </div>
                <div class="profile_stat">
                    <div class="profile_referrers"></div>
                </div>
            </div>
            <div class="clearfix">
                <div class="profile_stat">
                    <div class="profile_label">Comments</div>
                    <div class="profile_comments"></div>
                </div>
                <div class="profile_stat">
                    <div class="profile_label">Likes</div>
                    <div class="profile_comments"></div>
                </div>
            </div>
        </div>
    </script>
    <script type="text/templates" id="templates-pages-exhibit">
        <div id="exhibit" class="clearfix">
        </div>
    </script>
    <script type="text/templates" id="templates-components-story-input">
        <div class="field-close"><img src="{{urls.images}}/btn_close_x.png" /></div>
        <div class="field-title">Tell A Story</div>
        <div class="clearfix">
            <div class="field-main-col clearfix">
                <div class="field-input-label">Name Your Story</div>
                <div class="field-indent">
                    <input type="text">
                </div>
                <div class="field-input-label">Where did you buy it from?</div>
                <div class="field-indent">
                    <input type="text">
                </div>
                <div class="field-submit">Save and Continue</div>
            </div>
            <div class="field-side-col">
                <div class="field-indent clearfix">
                    <div class="field-input-label">Add Product Photo</div>
                    <div class="field-photo-container">
                        <div id="preview">
                            <img height="100px" src="" id="thumb">
                        </div>
                    </div>
                    <div id="field-fileupload"></div>
                    <!-- <div>Upload a Photo</div> -->
                </div>
            </div>
        </div>
    </script>
{{/header}}

{{$content}}
    <div id="container">
        <div id="header-container">
            <div id="logo">
                <a href="#"><img height="40px" src="{{urls.images}}/logo.png"></a>
            </div>

            <div id="user" class="clearfix">
                {{#echoedUser}}
                <div id="user-image">
                    {{#facebookId}}
                    <img id="u-i-i" height="30px" width="30px" src="http://graph.facebook.com/{{.}}/picture" />
                    {{/facebookId}}
                </div>
                <div id="user-text">
                    {{name}}( <span class="highlight"><strong><a id="logout" href="logout">Logout</a></strong></span> ) <br />
                </div>
                {{/echoedUser}}
            </div>
        </div>

        <div id="nav-container">
            {{#echoedUser}}
            <div id="actions"></div>
            <div id="header-nav" class="clearfix">
                <div class="nav-label">
                    Explore
                </div>
                <ul>
                    <li id="explore_nav">
                        <a href="#">
                            Just Purchased
                        </a>
                    </li>

                    <li id="friends_nav">
                        <a href="#me/friends">
                            My Friends
                        </a>
                    </li>
                    <li id="exhibit_nav">
                        <a href="#me">
                            Me
                        </a>
                    </li>
                </ul>
            </div>
            {{/echoedUser}}
            <!--<div id="networks">
                {{#echoedUser}}
                    {{#facebookUserId}}
                    <img id="facebookAccount" src="{{urls.images}}/btn_sq_clr_fb.png" alt="facebook"/>
                    {{/facebookUserId}}
                    {{^facebookUserId}}
                    <a id="addFacebookLink" href="https://www.facebook.com/dialog/oauth?client_id={{facebookClientId}}&redirect_uri={{http.site}}/facebook/add&scope=email,publish_stream,read_stream,offline_access">
                        <img src="{{urls.images}}/btn_sq_grey_fb.png" alt="facebook"/>
                    </a>
                    {{/facebookUserId}}
                    {{#twitterUserId}}
                    <img id="twitterAccount" src="{{urls.images}}/btn_sq_clr_tw.png" alt="twitter"/>
                    {{/twitterUserId}}
                    {{^twitterUserId}}
                    <a id="addTwitterLink" href="{{urls.site}}/twitter?redirect="/>
                        <img src="{{urls.images}}/btn_sq_grey_tw.png" alt="twitter"/>
                    </a>
                    {{/twitterUserId}}
                {{/echoedUser}}
            </div> -->
            {{^echoedUser}}
                <div id="login-container">
                    <ul>
                        <li>
                            <a id="facebookLogin" href="https://www.facebook.com/dialog/oauth?client_id={{facebookClientId}}&redirect_uri={{https.site}}/facebook/login&scope=email,user_birthday,publish_actions"><img class="login-button" src="{{urls.images}}/btn_facebook_login.png"></a>
                        </li>
                        <li>
                            <a id="twitterLogin" href="{{urls.site}}/twitter?redirect="><img class="login-button" src="{{urls.images}}/btn_twitter_login.png"></a>
                        </li>
                    </ul>
                </div>
            {{/echoedUser}}
            <div id="content-selector-container">
                <div id="content-selector" class="dropdown">
                    <div id="content-filter">
                        <div class="dd-header"></div>
                        <div class="dd-body"></div>
                    </div>
                    <div id="content-sort"></div>
                </div>
            </div>
            {{^echoedUser}}
            <div id="footer-nav">
                <ul>
                    <li><a href="{{urls.site}}/whatisechoed">About Us</a></li>
                    <li><a href="{{urls.site}}/business">For Business</a></li>
                    <li><a href="{{urls.site}}/privacy">Privacy Policy</a></li>
                    <li><a href="{{urls.site}}/terms">Terms of Service</a></li>
                </ul>
            </div>
            {{/echoedUser}}
        </div>
        <div id="content" class="clearfix"></div>
        <div id="field" style="display:none;"></div>
        <div id="transition" stype="display:none"></div>
        <div id="infiniteScroll" style="display:none;">
            Loading More Products <img align="absmiddle" src="{{urls.images}}/bk_loader_circle.gif" />
        </div>
        <div id="fade" style="display:none;"></div>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            Echoed.init();
        });
    </script>
    <script type="text/javascript">
        $.Isotope.prototype._getCenteredMasonryColumns = function() {
            this.width = this.element.width();

            var parentWidth = this.element.parent().width();

            // i.e. options.masonry && options.masonry.columnWidth
            var colW = this.options.masonry && this.options.masonry.columnWidth ||
                // or use the size of the first item
                    this.$filteredAtoms.outerWidth(true) ||
                // if there's no items, use size of container
                    parentWidth;

            var cols = Math.floor( parentWidth / colW );
            cols = Math.max( cols, 1 );

            // i.e. this.masonry.cols = ....
            this.masonry.cols = cols;
            // i.e. this.masonry.columnWidth = ...
            this.masonry.columnWidth = colW;
        };

        $.Isotope.prototype._masonryReset = function() {
            // layout-specific props
            this.masonry = {};
            // FIXME shouldn't have to call this again
            this._getCenteredMasonryColumns();
            var i = this.masonry.cols;
            this.masonry.colYs = [];
            while (i--) {
                this.masonry.colYs.push( 0 );
            }
        };

        $.Isotope.prototype._masonryResizeChanged = function() {
            var prevColCount = this.masonry.cols;
            // get updated colCount
            this._getCenteredMasonryColumns();
            return ( this.masonry.cols !== prevColCount );
        };

        $.Isotope.prototype._masonryGetContainerSize = function() {
            var unusedCols = 0,
                    i = this.masonry.cols;
            // count unused columns
            while ( --i ) {
                if ( this.masonry.colYs[i] !== 0 ) {
                    break;
                }
                unusedCols++;
            }

            return {
                height : Math.max.apply( Math, this.masonry.colYs ),
                // fit container to columns that have been used;
                width : (this.masonry.cols - unusedCols) * this.masonry.columnWidth
            };
        };
    </script>
{{/content}}

{{/user_super}}
